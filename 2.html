<!DOCTYPE html>
<html ng-app="notesApp">
	<head>
		<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
		<!--width=device-width為適應各式裝置螢幕大小 initial-scale=1為初始比例-->
		<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
		<!--X-UA-Compatible設置IE兼容模式；有什麼最新的版本IE，就用什麼版本的標準模式。-->
		<title>AngularJS TEST</title>

		<!-- <link href="css/reset.css" rel="stylesheet">  --><!--ResetCSS-->	
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="css/angularJS_TEST.css" rel="stylesheet"><!--自己寫的css要最後一個讀取-->

		<script src="js/jquery-2.2.0.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/angular.min.js"></script>
		<script>
			angular.module("notesApp",[])
			.controller("MainCtrl_1",["$http",function($http){
				var self = this;
				self.message = "init";
				self.getTest = function(){
					$http.get("http://g.e-hentai.org/api.php").then(
						function(response){
							console.log(response);
							self.message = response.data;
						},
						function(error){
							console.error("ERROR"+error);
						}
					);
				}
			}])

			.controller("MainCtrl_2",["$http", function($http){
				var self = this;
				self.message = "init";
				self.request = {
				  "method": "gdata",
				  "gidlist": [
				      [618395,"0439fa3666"]
				  ],
				  "namespace": 1
				};
				self.postTest = function(){
					$http.post("http://g.e-hentai.org/api.php", self.request).then(
						function(response){
							console.log(response);
							self.message = response.data.gmetadata[0].title_jpn;
						},
						function(error){
							console.error("ERROR"+error);
						})
				};
			}])

			.controller("MainCtrl_3",["$http", function($http){
				var url = "http://api.flickr.com/services/feeds/photos_public.gne?";
				var self = this;
				self.items = [];

				self.config = {
					params:{
						format:"json",			
						jsoncallback: "JSON_CALLBACK"
					}
				}

				self.jsonpTest = function(){
					$http.jsonp(url, self.config)
					.then(
						function(response){
							console.log(response);
							self.items = response.data.items;
							console.log(self.items);
						},
						function(error){
							console.error("ERROR"+error);
						})
				};
			}])


		</script>
	</head>
	<body  >
		<header>
			<div>
				<h1>AngularJS TEST</h1>
			</div>
			<ul class="nav nav-tabs nav-justified">
				<li  ><a href="index.html">1</a></li>
				<li class="active"><a href="#">2</a></li>
				<li ><a href="#">3</a></li>
			</ul>
		</header>

		<div class="container">
			<div class="row">

				<div class="col-sm-4" ng-controller="MainCtrl_1 as ctrl">
					<div class="panel panel-info">
						<div class="panel-heading">chapter6 / http-get-example</div>
						<div class="panel-body">

							<h3>{{ctrl.message}}</h3>
							<button class="btn btn-info" ng-click="ctrl.getTest()">GET</button>

						</div>
					</div>					
				</div>

				<div class="col-sm-4" ng-controller="MainCtrl_2 as ctrl">
					<div class="panel panel-info">
						<div class="panel-heading">chapter6 / http-post-example</div>
						<div class="panel-body">

							<p>{{ctrl.message}}</p>
							<button class="btn btn-info" ng-click="ctrl.postTest()">POST</button>

						</div>
					</div>					
				</div>

				<div class="col-sm-12" ng-controller="MainCtrl_3 as ctrl">
					<div class="panel panel-info">
						<div class="panel-heading">chapter6 / http-jsonp-example</div>
						<div class="panel-body">

							<div ng-init="ctrl.config.params.id = '55038205@N03'">
								<input type="text" ng-model="ctrl.config.params.id">我的flickr　或
								<input type="text" ng-model="ctrl.config.params.tags">搜尋tag
							</div>
							config.params：{{ctrl.config.params}}
							<hr/>

							<button class="btn btn-info btn-block" ng-click="ctrl.jsonpTest()">JSONP</button>

							<div class="image" ng-repeat="flickr in ctrl.items">
								<a href="{{ flickr.link }}">
									<img src="{{ flickr.media.m.replace('_m','_s') }}" alt="{{ flickr.title }}"/>
								</a>
							</div>

						</div>
					</div>					
				</div>

			</div>
		</div>

	</body>
</html>